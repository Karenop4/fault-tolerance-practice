version: "3.9"

services:
  gateway:
    build: ./services/gateway
    ports:
      - "5000:5000"
    environment:
      - RESERVATIONS_URL=http://reservations:5001
      - MAX_INFLIGHT=5
    depends_on:
      - reservations

  reservations:
    build: ./services/reservations
    ports:
      - "5001:5001"
    environment:
      - INVENTORY_URL=http://inventory:5002
      - PAYMENTS_URL=http://payments:5003
      - NOTIFICATIONS_URL=http://notifications:5004
      - DB_PATH=/data/reservations.db
    volumes:
      - reservations-data:/data
    depends_on:
      - inventory
      - payments
      - notifications

  inventory:
    build: ./services/inventory
    ports:
      - "5002:5002"

  payments:
    build: ./services/payments
    ports:
      - "5003:5003"

  notifications:
    build: ./services/notifications
    ports:
      - "5004:5004"

volumes:
  reservations-data:
